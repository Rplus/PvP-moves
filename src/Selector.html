<script>
  import Pm from './Pm.html';
  import Switcher from './Switcher.html';
  import { dex, defaultDex, datalist, pokemon, moves } from './stores.js';
  import { saveItem, getItem, toJSON } from './u.js';

  let dexInput;
  $: pms = [];

  // DEBUG
  let btn;
  window.xx = () => {
    console.log({
      pms,
    });
  };
  setTimeout(() => {
    btn.click();
  }, 100);

  function addPm() {
    let _dex = +dexInput.value;
    let pmData = $pokemon.find(pm => pm.dex === _dex);
    if (!pmData) {
      console.error(`Wrong Dex: ${_dex}`);
      // TODO: will be array
      $dex = defaultDex;
      return;
    }
    pms = pms.concat(pmData);
  }
</script>

<label for="pm-name-selector">Choose a pm:</label>
<input
  list="pm-names"
  id="pm-name-selector"
  name="pm-name-selector"
  bind:value="{$dex}"
  bind:this={dexInput}
/>
<button on:click={ addPm } bind:this={btn}>+</button>

<datalist id="pm-names">
  {@html $datalist }
</datalist>

<hr>
<Switcher />
<hr>

{#each pms as pm, index (index) }
  <section class="pm-section">
    {index}:
    <Pm pm={pm} />
  </section>
{/each}

<style>
.pm-section {
  /* max-width: 600px; */
}
</style>
